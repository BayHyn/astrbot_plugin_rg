# 左轮手枪游戏插件 README

## 一、插件概述  
基于 `AstrBot` 的群聊左轮手枪游戏插件，玩家可以在群聊中进行左轮手枪射击游戏，支持随机走火事件。复刻来自https://github.com/zgojin/astrbot_plugin_RG 。

## 二、插件信息  
- **插件名称**：revolver_game  
- **作者**：原作者zgojin  
- **关联物品**：左轮手枪插件  

## 三、功能介绍  

### 1. 装填子弹  
玩家可以使用 `[指令前缀]装填 [子弹数量]` 命令向 6 弹匣的左轮手枪中装填实弹。  
- **参数说明**：  
  - `[子弹数量]`：可选参数，必须为 1 到 6 之间的整数，默认值为 1。  
- **示例**：  
  - 若指令前缀为`/`，则`/装填`默认装填 1 发实弹；`/装填 3`装填 3 发实弹。  

### 2. 射击  
玩家使用 `[指令前缀]开枪` 命令进行射击。  
- 如果当前弹仓为实弹，玩家会被击中并被禁言（禁言时长为配置的随机范围，默认60-3000秒），同时游戏会输出相应的击中提示信息。  
- 如果当前弹仓为空弹，游戏会输出空枪提示信息，玩家可继续射击。  
- 当弹匣内的所有实弹都射出后，游戏结束，玩家可以再次装填开始新游戏。  

### 3. 随机走火  
在群聊中，有一定概率（默认为 0.005，可在控制台配置）触发随机走火事件。当走火发生时，会输出走火相关的提示信息，并且走火击中的玩家会被禁言（时长同射击的随机范围）。  

### 4. 走火功能开关  
- `[指令前缀]走火开`：开启本群的左轮手枪走火功能。  
- `[指令前缀]走火关`：关闭本群的左轮手枪走火功能。  

### 5. 游戏超时处理  
如果在装填子弹后超时时间内（默认60秒，可在控制台修改）没有玩家继续射击，游戏会自动结束，并输出相应的超时提示信息。  

## 四、配置说明  
插件支持在AstrBot控制台可视化修改以下参数（无需修改代码）：  
- **指令前缀**：触发插件指令的前缀（如`/`、`!`等，默认`/`，可留空表示无前缀）。  
- **随机走火概率**：默认0.005（0.5%），取值范围0-1。  
- **禁言时间范围**：默认60-3000秒，可自定义最小和最大时长。  
- **游戏超时时间**：默认60秒，装填后未操作的自动结束时间。  

## 五、更新  
### 1.5  
- 优化配置同步逻辑：控制台修改配置后无需重载插件，即时生效。  
- 新增游戏文本自定义支持：可通过`revolver_game_texts.yml`修改击中、空枪、走火等提示文本，适配不同场景话术。  
- 修复极端情况下超时计时器重复创建的bug，提升游戏稳定性。  

### 1.4  
修改原作者main.py内因为插件名字大写导致找不到文件，顺带把射爆改成开枪（个人喜好），增加随机禁言时间默认60-3000秒（支持通过控制台配置调整范围），新增指令前缀、走火概率、超时时间等控制台可配置项，提升易用性。  

### 1.3  
（别骂了别骂了）1.2版本只是把私聊消息非插件指令设置了不返回，但是实际上没有正确结束，然后我测试时一直只在群聊中测试是否有逻辑问题，没考虑到私聊导致插件出错，现在私聊只有触发插件相关指令才会提示，因此不会再导致错误（大概）  

### 1.2  
1.1版本忘记上传yml文件导致插件崩溃 修复私聊任何信息都会触发导致和其他插件冲突的问题  

### 1.1  
修复计时器结束后未正常输出消息的错误
